var i=void 0,l=null,m=!1,n=this;
function aa(){var a=console.log,b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}Math.floor(2147483648*Math.random()).toString(36);function p(a,b){var c=a.split("."),d=n;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==i?d[e]=b:d=d[e]?d[e]:d[e]={}};var q;String.prototype.toArray=function(){return this.split("").map(function(a){return parseInt("0x"+a,16)})};function r(a){return Math.floor(a/4)}HTMLElement.prototype.moveTo=function(a,b){var c=this.style;c.webkitTransitionDuration=c.MozTransitionDuration=c.i=c.f=c.j="250ms";c.MozTransform=c.webkitTransform=c.h=c.e="translate("+a+"px,"+b+"px)"};var s,t,u,v,w;var x,z;function A(a){if(x){var b=(new Date).getTime();console.log(b-z+"\t"+a);z=b}};Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;c<d;++c)a.call(b||this,this[c],c,this)});Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(this==l)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b);d=Array(g);for(e=0;e<g;){var h;if(e in f){h=f[e];h=a.call(c,h,e,f);d[e]=h}e++}return d});
Array.prototype.reduce||(Array.prototype.reduce=function(a){if(this===l||this===i)throw new TypeError("Object is null or undefined");var b=0,c=this.length>>0,d;if(typeof a!=="function")throw new TypeError("First argument is not callable");if(arguments.length<2){if(c===0)throw new TypeError("Array length is 0 and no second argument");d=this[0];b=1}else d=arguments[1];for(;b<c;){b in this&&(d=a.call(i,d,this[b],b,this));++b}return d});var B,C,D,E;function ba(){return n.navigator?n.navigator.userAgent:l}E=D=C=B=m;var F;if(F=ba()){var ca=n.navigator;B=0==F.indexOf("Opera");C=!B&&-1!=F.indexOf("MSIE");D=!B&&-1!=F.indexOf("WebKit");E=!B&&!D&&"Gecko"==ca.product}var G=C,H=E,da=D,I;
a:{var J="",K;if(B&&n.opera)var L=n.opera.version,J="function"==typeof L?L():L;else if(H?K=/rv\:([^\);]+)(\)|;)/:G?K=/MSIE\s+([^\);]+)(\)|;)/:da&&(K=/WebKit\/(\S+)/),K)var ea=K.exec(ba()),J=ea?ea[1]:"";if(G){var M,fa=n.document;M=fa?fa.documentMode:i;if(M>parseFloat(J)){I=""+M;break a}}I=J}var ga={};
function N(a){if(!ga[a]){for(var b=0,c=(""+I).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",o=RegExp("(\\d*)(\\D*)","g"),y=RegExp("(\\d*)(\\D*)","g");do{var j=o.exec(g)||["","",""],k=y.exec(h)||["","",""];if(0==j[0].length&&0==k[0].length)break;b=((0==j[1].length?0:parseInt(j[1],10))<(0==k[1].length?0:parseInt(k[1],10))?-1:(0==j[1].length?0:parseInt(j[1],10))>(0==k[1].length?
0:parseInt(k[1],10))?1:0)||((0==j[2].length)<(0==k[2].length)?-1:(0==j[2].length)>(0==k[2].length)?1:0)||(j[2]<k[2]?-1:j[2]>k[2]?1:0)}while(0==b)}ga[a]=0<=b}}var ha={};function ia(){return ha[9]||(ha[9]=G&&document.documentMode&&9<=document.documentMode)};!G||ia();!H&&!G||G&&ia()||H&&N("1.9.1");G&&N("9");G&&N(8);var O;(O="ScriptEngine"in n&&"JScript"==n.ScriptEngine())&&(n.ScriptEngineMajorVersion(),n.ScriptEngineMinorVersion(),n.ScriptEngineBuildVersion());function P(a,b){this.a=O?[]:"";a!=l&&this.append.apply(this,arguments)}O?(P.prototype.b=0,P.prototype.append=function(a,b,c){b==l?this.a[this.b++]=a:(this.a.push.apply(this.a,arguments),this.b=this.a.length);return this}):P.prototype.append=function(a,b,c){this.a+=a;if(b!=l)for(var d=1;d<arguments.length;d++)this.a+=arguments[d];return this};P.prototype.clear=function(){if(O)this.b=this.a.length=0;else this.a=""};
P.prototype.toString=function(){if(O){var a=this.a.join("");this.clear();a&&this.append(a);return a}return this.a};function Q(a){return"object"===typeof a&&a&&0===a.g?a.content:(""+a).replace(ja,ka)}var ma={"\x00":"&#0;",'"':"&quot;","&":"&amp;","'":"&#39;","<":"&lt;",">":"&gt;","\t":"&#9;","\n":"&#10;","\x0B":"&#11;","\u000c":"&#12;","\r":"&#13;"," ":"&#32;","-":"&#45;","/":"&#47;","=":"&#61;","`":"&#96;","\u0085":"&#133;","\u00a0":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};function ka(a){return ma[a]}var ja=/[\x00\x22\x26\x27\x3c\x3e]/g;function na(){var a=R.toArray(),b=R.split(""),c=new P;c.append("\t");var d=c||new P;d.append('\t<div id="field">');for(var e=b.length,f=0;f<e;f++){var g=b[f];d.append(a[f]?'<div id="element_'+Q(g)+'" class="field-element" onclick="fifteen.page.moveElement(\''+Q(g)+"')\">"+Q(a[f])+"</div>":"")}d.append("</div>");(c||new P).append('\t<div id="toolbar"><div class="toolbar-button"><div id="shuffle" class="pointer icon" onclick="fifteen.page.shuffle()"></div></div><div class="toolbar-button"><div id="play_stop" class="play pointer icon" onclick="fifteen.page.playOrStop()"></div></div><div class="toolbar-button"><a id="counter" class="pointer" onclick="fifteen.page.clearCounter()">0</a></div></div>');
return c.toString()};var R="123456789ABCDEF0",S=m,T=0;p("fifteen.page.moveElement",function(a){if(!S){var b=R,a=s[b.indexOf("0")][b.indexOf(a)];a!==i&&U(R.move(a))}});function U(a,b){if(a!=R||b){R=a;b?oa():(T++,$("#counter").html(T));var c=a.indexOf("0"),d=s,e;a.split("").forEach(function(a,b){if(a!="0"){e=$("#element_"+a);e.get(0).moveTo(b%4*47,r(b)*47);e.toggleClass("pointer",d[c][b]!==i&&!S)}})}}
p("fifteen.page.shuffle",function(){V();for(var a=U,b="1,2,3,4,5,6,7,8,9,A,B,C,D,E,F,0".split(","),c,d=0;16>d;d++){var e=Math.floor(16*Math.random());c=b[e];b[e]=b[d];b[d]=c}a(b.join(""),!0)});function pa(a){a!=S&&(S=a,$("#play_stop").toggleClass("stop play"),$("#counter").toggleClass("pointer",!a))}p("fifteen.page.playOrStop",function(){if(S)V();else if(!S){pa(!0);var a=qa(R);a?ra(a):(alert("This puzzle doesn't have solution"),V())}});function V(){S&&pa(m)}
function ra(a){if(S){var b=!a.length?m:a.slice(0,q);b==R&&(b=!a.length?m:a.slice(0,q));b?(U(b),window.setTimeout(function(){ra(!a.length?m:a.slice(q))},250)):V()}}function oa(){S||(T=0,$("#counter").html(T))}p("fifteen.page.clearCounter",oa);p("fifteen.page.initByArray",function(a){U(sa(a),!0)});function ta(a){return 1==a.toArray().reduce(function(a,c,d,e){return a+e.slice(d).reduce(function(a,b){return a+(c&&b?b<c?1:0:0)},0)},r(a.indexOf("0")))%2}function ua(a){var b=t,c=u,d=v,e=w;return a.split("").reduce(function(a,g,h){return a+4*("0"==g?0:Math.abs(d[h]-b[g])+Math.abs(e[h]-c[g]))},0)}String.prototype.move=function(a){var b=this.split(""),c=b.slice(0);a.forEach(function(a){c[a[1]]=b[a[0]]});return c.join("")};
function va(a){return s[a.indexOf("0")].map(function(a){return this.move(a)},a)}function sa(a){return a.reduce(function(a,c){return a+=c.reduce(function(a,b){return a+b.toString(16)},"")},"").toUpperCase()};function W(){this.data=[]}W.prototype.push=function(a,b){this.data[b]!==i||(this.data[b]=[]);this.data[b].push(a)};W.prototype.pop=function(){for(var a in this.data){var b=this.data[a].shift();0==this.data[a].length&&delete this.data[a];return b}};W.prototype.remove=function(a,b){for(var c=0;c<this.data[b].length;c++)if(this.data[b][c]==a){this.data[b].splice(c,1);break}0==this.data[b].length&&delete this.data[b]};var X,Y,Z;function qa(a){function b(){c++;var a=Z.pop(),b=X[a].parent;if("123456789ABCDEF0"==a)return b+a;delete X[a];Y[a]=!0;va(a).forEach(function(c){wa(c,b+a)});return m}A("Try to resolve "+a);if(!ta(a))return A("This node doesn't have solution "+a),m;var c=0;X={};Y={};Z=new W;wa(a,"");for(a="";!(a=b()););A("Solution found: "+(a.length/q-1)+" steps. Nodes checked: "+c);return a}
function wa(a,b){if(Y[a]===i){var c=1*(b.length/q-1),d=ua(a),d=c+d;if(X[a]!==i){if(c>=X[a].d)return;Z.remove(a,X[a].c)}X[a]={parent:b,d:c,c:d};Z.push(a,d)}};var xa="79C30AFEBD165248,36A870FD4915E2CB,A73654298CBFDE01,1FA754D3B68CE092,3507194C8EB6FAD2,A36297C1EFB4508D,137582CD4AB90FE6,054E83D72BA6F1C9,CE8514D02F976A3B".split(",");p("fifteen.tests.run",function(){xa.forEach(function(a){qa(a)});A("All tests completed")});$(document).ready(function(){q=Math.pow(4,2);var a=[],b=[],c={},d={},e,f;for(e=0;e<q;e++)f="123456789ABCDEF0".charAt(e),c[f]=r(e),d[f]=e%4,a[e]=r(e),b[e]=e%4;v=a;w=b;t=c;u=d;a=[];for(b=0;b<q;b++){a[b]=[];for(c=0;c<q;c++)a[b][c]=b==c?m:r(b)==r(c)||b%4==c%4}b={};for(c=0;c<q;c++){b[c]=[];for(d=0;d<q;d++)if(a[c][d]){e=b[c];for(var g=f=d,h=r(c),o=c%4,y=r(g),j=g%4,k=[[c,g]],ya=Math.abs(h-y)||Math.abs(o-j),la=h==y?1:4,h=h==y?o<j:h<y,o=0;o<ya;o++)k.push([g+la*(o+0)*(h?-1:1),g+la*(o+1)*(h?-1:1)]);e[f]=k}}s=
b;x=console!==i&&"function"==aa();z=(new Date).getTime();$("#fifteen").html(na());U(R,!0);X={};Y={};Z=new W});
